[tox]
envlist = py27-ansible{19,20,21,-devel}
skipsdist = True

[testenv]
whitelist_externals =
    make
    /bin/bash
    /usr/bin/docker

passenv =
    SSH_PRIVATE_KEY_PATH
    SSH_PUBLIC_KEY_PATH
    SSH_AUTH_SOCK

deps =
    ansible19: ansible>=1.9,<2.0
    ansible20: ansible>=2.0,<2.1
    ansible21: git+https://github.com/ansible/ansible.git@v2.1.0.0-0.2.rc2
    ansible-devel: git+https://github.com/ansible/ansible.git@devel
    ansible-lint
    pytest
    pytest-xdist
    testinfra

commands =
    ansible-lint 'tasks/main.yml' -v
    py.test -v -s
